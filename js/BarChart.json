{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "width": 920,
  "height": 460,
  "background": "white",
  "padding": {"top": 8, "left": 8, "right": 120, "bottom": 30},
  "data": {
    "url": "https://raw.githubusercontent.com/xwuu0082-cpu/Data-Visualisation-II/main/data/state_summary_all_years_ready_public_2001_2025.csv",
    "format": {"type": "csv"}
  },
  "transform": [
    {"filter": "toNumber(datum.year) == 2024"},
    {"calculate": "toNumber(datum.hospitals_count)", "as": "hospitals_num"},
    {"calculate": "toNumber(datum.population_65plus)", "as": "elderly_pop"},
    {"calculate": "(isFinite(datum.hospitals_num) && isFinite(datum.elderly_pop) && datum.elderly_pop > 0) ? (datum.hospitals_num / datum.elderly_pop) * 100000 : null", "as": "Hospitals_per_100k_elderly"},
    {"filter": "isFinite(datum.Hospitals_per_100k_elderly)"},
    {"joinaggregate": [{"op": "mean", "field": "Hospitals_per_100k_elderly", "as": "national_avg"}]}
  ],
  "title": {
    "text": "Hospital Resources per 100,000 People Aged 65 and Over, by State, 2024",
    "subtitle": "Jurisdictions with lower hospital-to-elderly ratios are likely to face greater service pressures as population ageing intensifies.",
    "anchor": "start",
    "font": "Inter, Arial, sans-serif",
    "fontSize": 20,
    "subtitleFontSize": 13
  },
  "layer": [
    {
      "mark": {"type": "bar", "cornerRadiusEnd": 5},
      "encoding": {
        "y": {
          "field": "state_name",
          "type": "nominal",
          "title": null,
          "sort": {"field": "Hospitals_per_100k_elderly", "order": "descending"}
        },
        "x": {
          "field": "Hospitals_per_100k_elderly",
          "type": "quantitative",
          "title": "Public Hospitals per 100,000 People Aged 65 and Over",
          "axis": {"grid": true, "tickCount": 6, "format": ".1f"},
          "scale": { "zero": true, "nice": true, "domainMax": 22 }
        },
        "color": {
          "field": "Hospitals_per_100k_elderly",
          "type": "quantitative",
          "scale": {"scheme": {"name": "cividis", "extent": [0.25, 1]}},
          "legend": {"title": "Hospitals per 100,000 (Aged 65+)"}
        },
        "tooltip": [
          {"field": "state_name", "title": "State/Territory"},
          {"field": "hospitals_num", "title": "Public Hospitals (Total)", "format": ","},
          {"field": "elderly_pop", "title": "Population Aged 65+", "format": ","},
          {"field": "Hospitals_per_100k_elderly", "title": "Hospitals per 100,000 (Aged 65+)", "format": ".2f"}
        ]
      }
    },
    {
      "mark": {"type": "rule", "strokeDash": [6, 4], "strokeWidth": 2, "color": "#555"},
      "encoding": {
        "x": {"field": "national_avg", "type": "quantitative"},
        "y": {"value": 0},
        "y2": {"value": 460}
      }
    },
    {
      "mark": {"type": "text", "align": "left", "fontWeight": "bold", "fontSize": 12, "color": "#555", "dx": 8, "dy": -10},
      "encoding": {
        "x": {"field": "national_avg", "type": "quantitative"},
        "y": {"value": 0},
        "text": {"value": "National Average"}
      }
    },
    {
      "mark": {"type": "text", "align": "left", "baseline": "middle", "dx": 6, "clip": true},
      "encoding": {
        "y": {
          "field": "state_name",
          "type": "nominal",
          "sort": {"field": "Hospitals_per_100k_elderly", "order": "descending"}
        },
        "x": {"field": "Hospitals_per_100k_elderly", "type": "quantitative"},
        "text": {"field": "Hospitals_per_100k_elderly", "type": "quantitative", "format": ".2f"},
        "color": {"value": "#2f2f2f"}
      }
    },
    {
      "data": {"values": [{"note": "Data Sources: Australian Institute of Health and Welfare (AIHW); Australian Bureau of Statistics (ABS), 2001â€“2025."}]},
      "mark": {"type": "text", "align": "left", "baseline": "bottom", "dx": 8, "dy": -6, "fontSize": 11, "fill": "#6b7280"},
      "encoding": {"x": {"value": 0}, "y": {"value": 520}, "text": {"field": "note"}}
    }
  ],
  "config": {
    "view": {"stroke": null},
    "axis": {
      "labelFont": "Inter, Arial, sans-serif",
      "titleFont": "Inter, Arial, sans-serif",
      "labelFontSize": 12,
      "titleFontSize": 12,
      "gridColor": "#e9e9e9"
    }
  }
}

